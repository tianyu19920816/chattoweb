# Web Element Extractor - 浏览器插件需求文档

## 1. 项目概述

### 1.1 项目背景
随着AI辅助编程的发展，开发者需要更高效的方式来提取网页元素信息并生成结构化的提示词。受Stagewise工具启发，我们计划开发一个浏览器插件，让用户能够在任何网页上选择元素并提取其完整上下文信息。

### 1.2 项目目标
- 开发一个跨浏览器的插件（支持Chrome、Edge、Firefox）
- 实现可视化的网页元素选择功能
- 自动提取选中元素的完整上下文信息
- 生成结构化的提示词供AI使用
- 支持多种输出格式和自定义模板

### 1.3 目标用户
- 前端开发者
- UI/UX设计师
- 自动化测试工程师
- AI提示词工程师
- 网页数据分析师

## 2. 功能需求

### 2.1 核心功能

#### 2.1.1 元素选择模式
- **单选模式**：点击选择单个元素
- **多选模式**：按住Ctrl/Cmd键选择多个元素
- **区域选择**：拖拽框选多个元素
- **智能选择**：自动识别相似元素（如列表项、表格行等）

#### 2.1.2 视觉反馈
- **悬停效果**：
  - 半透明蓝色覆盖层
  - 显示元素标签名和基本信息
  - 实时显示元素尺寸
- **选中效果**：
  - 红色实线边框
  - 显示操作按钮（删除、编辑、查看详情）
  - 元素编号标记（多选时）

#### 2.1.3 元素信息提取
- **DOM属性**：
  - 标签名、ID、类名
  - 自定义属性（data-*、aria-*等）
  - 事件监听器列表
- **样式信息**：
  - 计算后的CSS样式
  - 内联样式
  - CSS规则来源追踪
- **内容信息**：
  - 文本内容
  - HTML内容
  - 子元素数量和结构
- **位置信息**：
  - 绝对/相对位置
  - 尺寸信息
  - 视口内位置
- **层级信息**：
  - 完整的DOM路径
  - 父元素链
  - 兄弟元素信息

#### 2.1.4 提示词生成
- **预设模板**：
  - 通用Web开发模板
  - React组件提取模板
  - Vue组件提取模板
  - CSS样式提取模板
  - 自动化测试模板
- **自定义模板**：
  - 模板编辑器
  - 变量插值支持
  - 模板导入/导出
- **输出格式**：
  - 结构化XML
  - JSON格式
  - Markdown格式
  - 自定义格式

### 2.2 扩展功能

#### 2.2.1 智能分析
- **元素角色识别**：自动识别按钮、链接、表单等
- **设计系统检测**：识别使用的UI框架（Bootstrap、Ant Design等）
- **无障碍性分析**：检查ARIA属性和语义化标签
- **性能指标**：元素渲染时间、重绘次数等

#### 2.2.2 协作功能
- **选择历史**：保存和管理选择历史
- **分享功能**：生成可分享的元素选择链接
- **团队模板**：团队共享的提示词模板库
- **批注功能**：为选中元素添加说明和备注

#### 2.2.3 集成功能
- **剪贴板集成**：一键复制提示词
- **IDE集成**：发送到VSCode、WebStorm等
- **AI平台集成**：
  - OpenAI API直接调用
  - Claude API集成
  - 自定义API端点

### 2.3 用户界面需求

#### 2.3.1 插件弹出窗口
```
┌─────────────────────────────────┐
│  Web Element Extractor          │
├─────────────────────────────────┤
│ [开始选择] [多选模式] [设置]    │
├─────────────────────────────────┤
│ 已选择元素 (3)                  │
│ ┌─────────────────────────────┐ │
│ │ 1. <button> 提交按钮        │ │
│ │ 2. <input> 用户名输入框     │ │
│ │ 3. <div> 表单容器           │ │
│ └─────────────────────────────┘ │
├─────────────────────────────────┤
│ 输出格式: [JSON ▼]              │
│ 模板: [React组件 ▼]             │
│                                 │
│ [生成提示词] [清除选择]         │
└─────────────────────────────────┘
```

#### 2.3.2 悬浮工具栏
- 紧凑的悬浮按钮，可拖动位置
- 快速切换选择模式
- 实时显示选中元素数量
- 快捷操作按钮

#### 2.3.3 侧边栏面板
- 详细的元素信息展示
- 提示词预览和编辑
- 导出和分享选项
- 高级设置

## 3. 技术需求

### 3.1 技术架构
```
┌─────────────────────────────────────────┐
│           Content Script                 │
│  - DOM遍历和元素选择                    │
│  - 视觉反馈渲染                          │
│  - 事件监听和处理                        │
└────────────────┬────────────────────────┘
                 │
┌────────────────┴────────────────────────┐
│          Background Script               │
│  - 消息中转                              │
│  - 数据存储                              │
│  - API通信                               │
└────────────────┬────────────────────────┘
                 │
┌────────────────┴────────────────────────┐
│            Popup/Panel UI                │
│  - React应用                             │
│  - 状态管理                              │
│  - 用户界面                              │
└─────────────────────────────────────────┘
```

### 3.2 技术栈
- **前端框架**：React 18+ with TypeScript
- **状态管理**：Zustand / Redux Toolkit
- **样式方案**：Tailwind CSS + CSS-in-JS
- **构建工具**：Vite + CRXJS
- **测试框架**：Vitest + Playwright
- **代码质量**：ESLint + Prettier + Husky

### 3.3 浏览器API使用
- **Manifest V3**：使用最新的扩展标准
- **权限要求**：
  - `activeTab`：访问当前标签页
  - `storage`：保存用户设置和模板
  - `clipboardWrite`：复制功能
  - `contextMenus`：右键菜单集成

## 4. 非功能需求

### 4.1 性能要求
- 元素选择响应时间 < 50ms
- 大型页面（>1000个元素）流畅运行
- 内存占用 < 50MB
- 不影响原网页性能

### 4.2 兼容性要求
- Chrome 100+
- Edge 100+
- Firefox 100+
- 支持主流Web框架构建的网站
- 支持SPA（单页应用）

### 4.3 安全性要求
- 不收集用户隐私数据
- 本地存储加密
- 安全的跨域通信
- 防止XSS攻击

### 4.4 易用性要求
- 零配置开箱即用
- 直观的视觉反馈
- 键盘快捷键支持
- 多语言支持（中文、英文）

## 5. 开发计划

### 5.1 第一阶段（MVP - 4周）
- [ ] 基础架构搭建
- [ ] 单元素选择功能
- [ ] 基本信息提取
- [ ] JSON格式输出
- [ ] Chrome浏览器支持

### 5.2 第二阶段（核心功能 - 6周）
- [ ] 多元素选择
- [ ] 完整信息提取
- [ ] 预设模板系统
- [ ] 多种输出格式
- [ ] Edge和Firefox支持

### 5.3 第三阶段（高级功能 - 8周）
- [ ] 智能分析功能
- [ ] 自定义模板
- [ ] 协作功能
- [ ] AI平台集成
- [ ] 性能优化

## 6. 成功指标

### 6.1 技术指标
- 元素选择准确率 > 99%
- 信息提取完整度 > 95%
- 插件加载时间 < 100ms
- 崩溃率 < 0.1%

### 6.2 用户指标
- 日活跃用户 > 10,000
- 用户留存率（7天）> 60%
- 用户满意度 > 4.5/5
- Chrome商店评分 > 4.0

## 7. 风险评估

### 7.1 技术风险
- **风险**：不同网站的DOM结构差异大
- **缓解**：建立常见框架的适配器库

### 7.2 用户体验风险
- **风险**：复杂页面上的性能问题
- **缓解**：实现渐进式渲染和虚拟化

### 7.3 维护风险
- **风险**：浏览器API变更
- **缓解**：建立兼容层，定期更新

## 8. 附录

### 8.1 竞品分析
- **Stagewise**：需要本地安装，仅支持开发环境
- **Chrome DevTools**：功能强大但不够直观
- **WhatFont**：仅针对字体信息
- **我们的优势**：浏览器原生、全面信息提取、AI优化

### 8.2 用户故事示例
1. 作为前端开发者，我想快速提取某个组件的完整样式，以便在我的项目中复用
2. 作为测试工程师，我想获取页面元素的选择器，以便编写自动化测试
3. 作为AI使用者，我想生成描述网页元素的提示词，让AI帮我重构代码

### 8.3 技术参考
- Chrome Extension API文档
- Manifest V3迁移指南
- React Chrome Extension模板
- Shadow DOM最佳实践